<!DOCTYPE html>
<html lang="en">
<title>CMSC23210 Password Study</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif}
.w3-bar,h1,button {font-family: "Montserrat", sans-serif}
.fa-anchor,.fa-coffee {font-size:200px}
</style>
<body>


<!-- Header -->
<header class="w3-container w3-red w3-center" style="padding:128px 16px">
  <h1 class="w3-margin w3-jumbo">CMSC 23210 Password Study</h1>
  <p class="w3-xlarge">Thank you for participating</p>
</header>

<!-- First Grid -->
<div class="w3-row-padding w3-padding-64 w3-container">
  <div class="w3-content">
    <div class="w3-twothird">
      <h1>PLEASE READ - TASK</h1>
      <h5 class="w3-padding-32">You will be writing 10 passwords a day based on a prompt that will change daily.</h5>

      <p class="w3-text-grey">When you finish writing the passwords a download button will appear. Click the button to download a 
        simple text file containing some data. We will not save any of your passwords that you have written down, but please do not use any 
        of your real passwords for this study. You may open the file to confirm that we haven't stored any of the passwords, but please do not edit the text in the file in anyway. After downloading the file, please email it
      to either obichouna@uchicago.edu or jayyala@gmail.com. Thank you again. </p>
    </div>

    <div class="w3-third w3-center">
      <i class="fa fa-anchor w3-padding-64 w3-text-red"></i>
    </div>
  </div>
</div>

<!-- Second Grid -->
<div class="w3-row-padding w3-light-grey w3-padding-64 w3-container">
  <div class="w3-content">
    <div class="w3-third w3-center">
      <i class="fa fa-coffee w3-padding-64 w3-text-red w3-margin-right"></i>
    </div>

    <div class="w3-twothird">
      <h1>Let's say you're making a password for "Goggle.com"</h1>
      <h5 class="w3-padding-32">Please write 10 passwords here. Make sure to click enter after each password!</h5>

      <p class="w3-text-grey">
        Username: <input type="username" id="usr" value="">
        Password: <input type="password" id="psw" value="">
        
        <button onclick="display()">Try it</button>
        <div id="container"></div>
        <p id="upper"></p>
        <p id="finished"></p>
	<p id="suggestion"></p>
      </p>
    </div>
  </div>
</div>

<div class="w3-container w3-black w3-center w3-opacity w3-padding-64">
    <h1 class="w3-margin w3-xlarge">CMSC 23210: Usable Security and Privacy</h1>
</div>


<script>
function download(filename, text) {
    
    element.style.display = 'none';
    document.body.appendChild(element);

    document.body.removeChild(element);
}

var scores = [];
function display() {
  if (scores.length <= 10){
	var x = document.getElementById("psw").value;
  	var upper = (x.match(/[A-Z]/g) || []).length;
  	var lower = (x.match(/[a-z]/g) || []).length;
  	var numbers = (x.match(/[0-9]/g) || []).length;
  	var length = x.length;
	var consecutive = 0;
	var common = 0;
	var chars = []
	var unique = length;
	for (let i=0;i<length;i++){
		if (x[i] == x[i+1]){
			consecutive += 1;
		}
		if (!(x[i] in chars)){
			chars.push(x[i]);
		}
	}
	unique = chars.length;
	common = (x == "123456" || x == "123456789" || x == "qwerty" || x == "111111" || x == "password" || x == "abc" || x == "password1" || x == "picture1");
  	var spec = (x.match(/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/g) || []).length;
  	var score = (3*upper + lower + 2*numbers + length + 4*spec - consecutive)*(unique/length);
	if (common == 1){
		score = 0;
	}
  	document.getElementById("upper").innerHTML = score;
	if (upper == 0){
		document.getElementById("suggestion").innerHTML = "Add an upper case letter to your password";	

	}
	else if (numbers == 0){
		document.getElementById("suggestion").innerHTML = "Add a number to your password";
	}
	else if (length < 6){
		document.getElementById("upper").innerHTML = "Make your password longer";
	}
	else if (consecutive == 1){
		document.getElementById("upper").innerHTML = "Don't have consective characters that are the same";
	}
	else if (unique/length < 0.7){
		document.getElementById("upper").innerHTML = "Use more unique characters";
	}
	else if (common == 1){
		document.getElementById("upper").innerHTML = "This password is too common, create another one";
	}
	else if (spec == 0){
		document.getElementById("upper").innerHTML = "Add a special character (#,$,% etc.) to your password";
	}
  	var d = new Date();
  	var day = d.getDay();
  	var hour = d.getHours();
  	var minute = d.getMinutes();
  	scores.push(score);
  }
  else {
	var d = new Date();
	var day = d.getDate();
 	var f_name = "Day " + day + " Password Scores" + ".txt";
        document.getElementById("upper").innerHTML = "You Are Done For Today!";
	var button = document.createElement('button');
	button.type = 'button';
    	button.innerHTML = 'Download Your Scores';
	var element = document.createElement('a');
	var text = scores.toString();
    	element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
    	element.setAttribute('download', f_name);
	var button = document.createElement("button");
	button.appendChild(document.createTextNode("Download Your Scores"));
	element.appendChild(button);
	var container = document.getElementById('container');
    	container.appendChild(element);
  }
}
</script>

</body>
</html>
